define("oj-c/tag-cloud-item/tag-cloud-item",["require","exports","@oracle/oraclejet-preact/translationBundle","ojs/ojvcomponent"],(function(require,e,t,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TagCloudItem=e.TagCloudItemDefaults=void 0,e.TagCloudItemDefaults={categories:[]},e.TagCloudItem=(0,a.registerCustomElement)("oj-c-tag-cloud-item",(({categories:t=e.TagCloudItemDefaults.categories,...a})=>null),"TagCloudItem",{properties:{categories:{type:"Array<string>"},color:{type:"string"},label:{type:"string"},value:{type:"number|null"},url:{type:"string"},shortDesc:{type:"string"}}},void 0,{"@oracle/oraclejet-preact":t.default})})),define("oj-c/tag-cloud/utils",["require","exports","../tag-cloud-item/tag-cloud-item"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.executeLink=e.transformItem=void 0,e.transformItem=function(e){const a={...t.TagCloudItemDefaults,...e};return{color:a.color,accessibleLabel:a.shortDesc,value:a.value,label:a.label,id:null!=a.key?a?.key:a.id,role:a.url?"link":void 0}},e.executeLink=function(e){const t=window.open(e,"_blank");t&&t.focus()}})),define("oj-c/hooks/UNSAFE_useVizCategories/useVizCategories",["require","exports","@oracle/oraclejet-preact/hooks/UNSAFE_useCategories"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useVizCategories=void 0,e.useVizCategories=function(e,a,o,i,r="any",s="all",n,d){const{ids:l,updateCategories:c}=(0,t.useCategories)(e,a,o,r,!1,n),{ids:u,updateCategories:h}=(0,t.useCategories)(e,a,i,s,!0,d);return{hiddenIds:l,updateHidden:c,highlightedIds:u,updateHighlighted:h}}})),define("oj-c/hooks/UNSAFE_useDataProvider/utils",["require","exports"],(function(require,e){"use strict";function t(e,t,a,o){const i=[...o];return e.forEach(((e,o)=>{const r={data:t[o],key:a[o]?.key,metadata:a[o]};e>=0?i.splice(e,0,r):i.push(r)})),i}async function a(e,t){const a=[],o=(await e.fetchByKeys({keys:t})).results;for(const e of t)if(o.has(e)){const t=o.get(e);a.push({...t,key:e})}return a}function o(e,t){return e.has(t)?e.get(t):-1}function i(e,t){const a=[...t];return e.sort(((e,t)=>t-e)),e.forEach((e=>{e<a.length&&a.splice(e,1)})),a}Object.defineProperty(e,"__esModule",{value:!0}),e.getUpdatedItemsFromMutationDetail=void 0,e.getUpdatedItemsFromMutationDetail=async function(e,r,s){const{add:n,remove:d,update:l}=e??{},c=new Map;for(const[e,t]of r.entries())c.set(t.key,e);let u=[...r];return d&&(u=function(e,t,a){const{indexes:r,keys:s}=e;let n=[...t];r?.length?n=i(r,n):s?.size&&(n=function(e,t,a){const r=[];return e.forEach((e=>{const t=o(a,e);-1!==t&&r.push(t)})),i(r,t)}(s,n,a));return n}(d,u,c)),n&&(u=await async function(e,i,r,s){const{addBeforeKeys:n,data:d,indexes:l,keys:c,metadata:u}=e;let h=[...i],p=d||[],g=u||[];if(0===p.length&&c?.size){const e=await a(s,c)??[];p=e.map((e=>e.data)),g=e.map((e=>e.metadata))}0===g.length&&c?.size&&(g=[...c].map((e=>({key:e}))));p.length&&(h=l?.length?t(l,p,g,h):n?.length?function(e,a,i,r){const s=[],n=[];return e.forEach((e=>{s.push(o(r,e)),n.push({key:e})})),t(s,a,n,i)}(n,p,h,r):function(e,a,o){return t(new Array(e.length).fill(-1),e,a,o)}(p,g,h));return h}(n,u,c,s)),l&&(u=await async function(e,t,i,r){const{data:s,indexes:n,keys:d,metadata:l}=e;let c=[...t],u=s||[],h=l||[];if(0===u.length&&d?.size){const e=await a(r,d)??[];u=e.map((e=>e.data)),h=e.map((e=>e.metadata))}0===h.length&&d?.size&&(h=[...d].map((e=>({key:e}))));u.length&&(n?.length?c=function(e,t,a,o){const i=[...o];return e.forEach(((e,o)=>{if(i[e]){const r={data:t[o],key:a[o]?.key,metadata:a[o]};i.splice(e,1,r)}})),i}(n,u,h,c):d?.size&&(c=function(e,t,a,i,r){const s=[...i];return e.forEach((e=>{const i=o(r,e),n={data:t[i],key:a[i]?.key,metadata:a[i]};i>=0&&s.splice(i,1,n)})),s}(d,u,h,c,i)));return c}(l,u,c,s)),u}})),define("oj-c/hooks/UNSAFE_useDataProvider/DataProviderHandler",["require","exports","./utils"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DataProviderHandler=void 0;e.DataProviderHandler=class{constructor(e,a,o){this.handleMutateEvent=async e=>{const{detail:a}=e,o=this.addBusyState("updating data from mutation event"),i=await(0,t.getUpdatedItemsFromMutationDetail)(a,this.currentData,this.dataProvider);o?.(),this.currentData=i,this.callback?.onDataUpdated?.(i)},this.handleRefreshEvent=()=>{this._fetchDataAndNotify()},this.addBusyState=a,this.callback=o,this.dataProvider=e,this.currentData=[],e.addEventListener("refresh",this.handleRefreshEvent),e.addEventListener("mutate",this.handleMutateEvent),this._fetchDataAndNotify()}destroy(){this.callback=void 0,this.currentData=[],this.dataProvider.removeEventListener("refresh",this.handleRefreshEvent),this.dataProvider.removeEventListener("mutate",this.handleMutateEvent)}async _fetchData(){const e=[],t=this.dataProvider.fetchFirst({size:-1});for await(const a of t){const t=a.data.map(((e,t)=>({data:e,key:a.metadata[t].key,metadata:a.metadata[t]})));e.push(...t)}return this.currentData=e.slice(),e}async _fetchDataAndNotify(){const e=this.addBusyState("fetching data"),t=await this._fetchData();this.callback?.onDataUpdated?.(t),e()}}})),define("oj-c/hooks/UNSAFE_useDataProvider/useDataProvider",["require","exports","preact/hooks","./DataProviderHandler"],(function(require,e,t,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useDataProvider=void 0,e.useDataProvider=function({addBusyState:e,data:o}){const[i,r]=(0,t.useState)([]),s=(0,t.useRef)();return(0,t.useEffect)((()=>(void 0!==o&&(s.current=new a.DataProviderHandler(o,e,{onDataUpdated:r})),()=>{s.current?.destroy(),s.current=void 0})),[o,e]),{data:i}}})),define("oj-c/utils/UNSAFE_vizUtils/TemplateHandler",["require","exports","preact/compat"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.processTemplate=e.processNodeTemplate=void 0;const a=e=>Object.keys(e).reduce(((t,a)=>("children"===a||(t[(e=>e[0].toLowerCase()!==e[0]?e.toLowerCase().replace(/-./g,(e=>e[1].toUpperCase())):e)(a)]=e[a]),t)),{});e.processNodeTemplate=(e,o,i,r)=>{const s=o(i),n=t.Children.toArray(s).find((e=>{if(e&&e.props)return(e.props?.children?.type||e.type)===r})),d=n?.type===r?n.props:(n?.props?.children).props,l=e.key||e.metadata?.key;return d?{...a(d),key:l,id:l,_itemData:e.data}:{key:l,id:l,_itemData:e.data}};e.processTemplate=(t,a,o,i)=>t.map(((t,r)=>(0,e.processNodeTemplate)(t,a,o(t,r),i)))})),define("oj-c/tag-cloud/tag-cloud",["require","exports","preact/jsx-runtime","@oracle/oraclejet-preact/translationBundle","preact/hooks","preact/compat","@oracle/oraclejet-preact/UNSAFE_TagCloud","ojs/ojcontext","./utils","@oracle/oraclejet-preact/UNSAFE_VisStatusMessage","../hooks/UNSAFE_useVizCategories/useVizCategories","ojs/ojvcomponent","./utils","../hooks/UNSAFE_useDataProvider/useDataProvider","../utils/UNSAFE_vizUtils/TemplateHandler","css!oj-c/tag-cloud/tag-cloud-styles.css"],(function(require,e,t,a,o,i,r,s,n,d,l,c,u,h,p){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TagCloud=void 0,e.TagCloud=(0,c.registerCustomElement)("oj-c-tag-cloud",(function({hiddenCategories:e=[],data:a=null,highlightedCategories:g=[],hoverBehavior:y="none",layout:m="rectangular",selection:f=[],selectionMode:v="none",highlightMatch:k="all",...C}){const _=(0,o.useRef)(null),b=(0,o.useCallback)((e=>_.current?s.getContext(_.current).getBusyContext().addBusyState({description:e}):()=>{}),[]),{data:D}=(0,h.useDataProvider)({data:a||void 0,addBusyState:b}),j="dim"===y,E=(0,o.useCallback)(((e,t)=>({data:e.data,key:e.key,index:t})),[]),P=(0,i.useMemo)((()=>C.itemTemplate?(0,p.processTemplate)(D,C.itemTemplate,E,"oj-c-tag-cloud-item"):D.map((e=>e.data))),[C.itemTemplate,D,E]),[M,S]=(0,i.useMemo)((()=>{const e=new Map,t=P.map((t=>(null==t.id&&null==t.key||e.set(t.id||t.key,t),(0,u.transformItem)(t))));return[e,t]}),[P]),[T,A]=(0,i.useMemo)((()=>{let e=!1;const t=P.map(((t,a)=>(e=e||null!=t.url,{id:S[a].id,categories:t.categories||[]})));return[e,t]}),[S,P]),{hiddenIds:I,highlightedIds:x,updateHighlighted:w}=(0,l.useVizCategories)(A,(e=>e.categories),e,g,"any",k,C.onHiddenCategoriesChanged,C.onHighlightedCategoriesChanged),U=null!=C.datatip?e=>({content:C.datatip?.({id:e.data.id}),borderColor:void 0}):void 0;return(0,t.jsx)(c.Root,{ref:_,children:a&&0!==P.length?(0,t.jsx)(r.TagCloud,{layout:m,datatip:U,highlightedIds:j?x:void 0,hiddenIds:I,accessibleLabel:C["aria-label"],"aria-describedBy":C["aria-describedby"],"aria-labelledBy":C["aria-labelledby"],items:S,selectionMode:v,onSelectionChange:e=>{C.onSelectionChanged?.(e.ids)},onItemAction:T?e=>{const t=M.get(e.id);t?.url&&(0,n.executeLink)(t.url)}:void 0,onItemInput:e=>{j&&w(e.id)},selectedIds:"none"===v?void 0:f,width:"100%",height:"100%"}):(0,t.jsx)(d.VisNoData,{"aria-label":C["aria-label"]})})}),"TagCloud",{properties:{data:{type:"DataProvider|null"},datatip:{type:"function"},hiddenCategories:{type:"Array<string>",writeback:!0},touchResponse:{type:"string",enumValues:["auto","touchStart"]},highlightMatch:{type:"string",enumValues:["all","any"]},highlightedCategories:{type:"Array<string>",writeback:!0},hoverBehavior:{type:"string",enumValues:["none","dim"]},layout:{type:"string",enumValues:["cloud","rectangular"]},selectionMode:{type:"string",enumValues:["none","multiple","single"]},selection:{type:"Array<any>",writeback:!0}},slots:{itemTemplate:{data:{}}},extension:{_WRITEBACK_PROPS:["hiddenCategories","highlightedCategories","selection"],_READ_ONLY_PROPS:[],_OBSERVED_GLOBAL_PROPS:["aria-label","aria-describedby","aria-labelledby"]}},{hiddenCategories:[],data:null,highlightedCategories:[],hoverBehavior:"none",layout:"rectangular",selection:[],selectionMode:"none",highlightMatch:"all"},{"@oracle/oraclejet-preact":a.default})}));
//# sourceMappingURL=tag-cloud.js.map