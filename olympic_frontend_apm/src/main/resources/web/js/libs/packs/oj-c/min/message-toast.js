define("oj-c/hooks/UNSAFE_useDataProvider/utils",["require","exports"],(function(require,e){"use strict";function t(e,t,a,s){const o=[...s];return e.forEach(((e,s)=>{const n={data:t[s],key:a[s]?.key,metadata:a[s]};e>=0?o.splice(e,0,n):o.push(n)})),o}async function a(e,t){const a=[],s=(await e.fetchByKeys({keys:t})).results;for(const e of t)if(s.has(e)){const t=s.get(e);a.push({...t,key:e})}return a}function s(e,t){return e.has(t)?e.get(t):-1}function o(e,t){const a=[...t];return e.sort(((e,t)=>t-e)),e.forEach((e=>{e<a.length&&a.splice(e,1)})),a}Object.defineProperty(e,"__esModule",{value:!0}),e.getUpdatedItemsFromMutationDetail=void 0,e.getUpdatedItemsFromMutationDetail=async function(e,n,r){const{add:i,remove:d,update:c}=e??{},u=new Map;for(const[e,t]of n.entries())u.set(t.key,e);let l=[...n];return d&&(l=function(e,t,a){const{indexes:n,keys:r}=e;let i=[...t];n?.length?i=o(n,i):r?.size&&(i=function(e,t,a){const n=[];return e.forEach((e=>{const t=s(a,e);-1!==t&&n.push(t)})),o(n,t)}(r,i,a));return i}(d,l,u)),i&&(l=await async function(e,o,n,r){const{addBeforeKeys:i,data:d,indexes:c,keys:u,metadata:l}=e;let h=[...o],f=d||[],p=l||[];if(0===f.length&&u?.size){const e=await a(r,u)??[];f=e.map((e=>e.data)),p=e.map((e=>e.metadata))}0===p.length&&u?.size&&(p=[...u].map((e=>({key:e}))));f.length&&(h=c?.length?t(c,f,p,h):i?.length?function(e,a,o,n){const r=[],i=[];return e.forEach((e=>{r.push(s(n,e)),i.push({key:e})})),t(r,a,i,o)}(i,f,h,n):function(e,a,s){return t(new Array(e.length).fill(-1),e,a,s)}(f,p,h));return h}(i,l,u,r)),c&&(l=await async function(e,t,o,n){const{data:r,indexes:i,keys:d,metadata:c}=e;let u=[...t],l=r||[],h=c||[];if(0===l.length&&d?.size){const e=await a(n,d)??[];l=e.map((e=>e.data)),h=e.map((e=>e.metadata))}0===h.length&&d?.size&&(h=[...d].map((e=>({key:e}))));l.length&&(i?.length?u=function(e,t,a,s){const o=[...s];return e.forEach(((e,s)=>{if(o[e]){const n={data:t[s],key:a[s]?.key,metadata:a[s]};o.splice(e,1,n)}})),o}(i,l,h,u):d?.size&&(u=function(e,t,a,o,n){const r=[...o];return e.forEach((e=>{const o=s(n,e),i={data:t[o],key:a[o]?.key,metadata:a[o]};o>=0&&r.splice(o,1,i)})),r}(d,l,h,u,o)));return u}(c,l,u,r)),l}})),define("oj-c/hooks/UNSAFE_useDataProvider/DataProviderHandler",["require","exports","./utils"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DataProviderHandler=void 0;e.DataProviderHandler=class{constructor(e,a,s){this.handleMutateEvent=async e=>{const{detail:a}=e,s=this.addBusyState("updating data from mutation event"),o=await(0,t.getUpdatedItemsFromMutationDetail)(a,this.currentData,this.dataProvider);s?.(),this.currentData=o,this.callback?.onDataUpdated?.(o)},this.handleRefreshEvent=()=>{this._fetchDataAndNotify()},this.addBusyState=a,this.callback=s,this.dataProvider=e,this.currentData=[],e.addEventListener("refresh",this.handleRefreshEvent),e.addEventListener("mutate",this.handleMutateEvent),this._fetchDataAndNotify()}destroy(){this.callback=void 0,this.currentData=[],this.dataProvider.removeEventListener("refresh",this.handleRefreshEvent),this.dataProvider.removeEventListener("mutate",this.handleMutateEvent)}async _fetchData(){const e=[],t=this.dataProvider.fetchFirst({size:-1});for await(const a of t){const t=a.data.map(((e,t)=>({data:e,key:a.metadata[t].key,metadata:a.metadata[t]})));e.push(...t)}return this.currentData=e.slice(),e}async _fetchDataAndNotify(){const e=this.addBusyState("fetching data"),t=await this._fetchData();this.callback?.onDataUpdated?.(t),e()}}})),define("oj-c/hooks/UNSAFE_useDataProvider/useDataProvider",["require","exports","preact/hooks","./DataProviderHandler"],(function(require,e,t,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useDataProvider=void 0,e.useDataProvider=function({addBusyState:e,data:s}){const[o,n]=(0,t.useState)([]),r=(0,t.useRef)();return(0,t.useEffect)((()=>(void 0!==s&&(r.current=new a.DataProviderHandler(s,e,{onDataUpdated:n})),()=>{r.current?.destroy(),r.current=void 0})),[s,e]),{data:o}}})),define("oj-c/message-toast/message-toast",["require","exports","preact/jsx-runtime","@oracle/oraclejet-preact/translationBundle","@oracle/oraclejet-preact/UNSAFE_MessageToast","@oracle/oraclejet-preact/hooks/UNSAFE_useMessagesContext","oj-c/hooks/UNSAFE_useDataProvider/useDataProvider","ojs/ojvcomponent","preact/hooks","ojs/ojcontext","css!oj-c/message-toast/message-toast-styles.css"],(function(require,e,t,a,s,o,n,r,i,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MessageToast=void 0,e.MessageToast=(0,r.registerCustomElement)("oj-c-message-toast",(function({data:e,detailTemplateValue:a,iconTemplateValue:c,messageTemplates:u,offset:l=0,position:h="bottom",onOjClose:f}){const p=(0,i.useRef)((0,r.getUniqueId)()),m=(0,i.useRef)(),[y,v]=(0,i.useState)(e),[g,D]=(0,i.useState)(0),k=(0,i.useCallback)(((e="MessageToast: busyState")=>m.current?d.getContext(m.current).getBusyContext().addBusyState({description:e}):()=>{}),[]);e!=y&&(v(e),D((e=>e+1)));const{data:j}=(0,n.useDataProvider)({data:e,addBusyState:k}),E=`messageToastLayer_${p.current}`,P=(0,i.useMemo)((()=>({addBusyState:k,UNSAFE_messagesLayerId:E})),[k,E]);return(0,t.jsx)(r.Root,{ref:m,"data-oj-messages-layer-id":E,children:(0,t.jsx)(o.MessagesContext.Provider,{value:P,children:(0,t.jsx)(s.MessageToast,{data:j,detailRendererKey:a,iconRendererKey:c,offset:l,onClose:f,position:h,renderers:u},g)})})}),"MessageToast",{properties:{data:{type:"DataProvider"},detailTemplateValue:{type:"string|function"},iconTemplateValue:{type:"string|function"},offset:{type:"number|object"},position:{type:"string",enumValues:["top","bottom","top-start","top-end","bottom-end","bottom-start","top-left","top-right","bottom-left","bottom-right"]}},extension:{_DYNAMIC_SLOT:{prop:"messageTemplates",isTemplate:1}},events:{ojClose:{}}},{offset:0,position:"bottom"},{"@oracle/oraclejet-preact":a.default})}));
//# sourceMappingURL=message-toast.js.map