define("oj-c/hooks/UNSAFE_useDataProvider/utils",["require","exports"],(function(require,e){"use strict";function t(e,t,a,s){const n=[...s];return e.forEach(((e,s)=>{const r={data:t[s],key:a[s]?.key,metadata:a[s]};e>=0?n.splice(e,0,r):n.push(r)})),n}async function a(e,t){const a=[],s=(await e.fetchByKeys({keys:t})).results;for(const e of t)if(s.has(e)){const t=s.get(e);a.push({...t,key:e})}return a}function s(e,t){return e.has(t)?e.get(t):-1}function n(e,t){const a=[...t];return e.sort(((e,t)=>t-e)),e.forEach((e=>{e<a.length&&a.splice(e,1)})),a}Object.defineProperty(e,"__esModule",{value:!0}),e.getUpdatedItemsFromMutationDetail=void 0,e.getUpdatedItemsFromMutationDetail=async function(e,r,o){const{add:i,remove:d,update:c}=e??{},u=new Map;for(const[e,t]of r.entries())u.set(t.key,e);let l=[...r];return d&&(l=function(e,t,a){const{indexes:r,keys:o}=e;let i=[...t];r?.length?i=n(r,i):o?.size&&(i=function(e,t,a){const r=[];return e.forEach((e=>{const t=s(a,e);-1!==t&&r.push(t)})),n(r,t)}(o,i,a));return i}(d,l,u)),i&&(l=await async function(e,n,r,o){const{addBeforeKeys:i,data:d,indexes:c,keys:u,metadata:l}=e;let h=[...n],f=d||[],p=l||[];if(0===f.length&&u?.size){const e=await a(o,u)??[];f=e.map((e=>e.data)),p=e.map((e=>e.metadata))}0===p.length&&u?.size&&(p=[...u].map((e=>({key:e}))));f.length&&(h=c?.length?t(c,f,p,h):i?.length?function(e,a,n,r){const o=[],i=[];return e.forEach((e=>{o.push(s(r,e)),i.push({key:e})})),t(o,a,i,n)}(i,f,h,r):function(e,a,s){return t(new Array(e.length).fill(-1),e,a,s)}(f,p,h));return h}(i,l,u,o)),c&&(l=await async function(e,t,n,r){const{data:o,indexes:i,keys:d,metadata:c}=e;let u=[...t],l=o||[],h=c||[];if(0===l.length&&d?.size){const e=await a(r,d)??[];l=e.map((e=>e.data)),h=e.map((e=>e.metadata))}0===h.length&&d?.size&&(h=[...d].map((e=>({key:e}))));l.length&&(i?.length?u=function(e,t,a,s){const n=[...s];return e.forEach(((e,s)=>{if(n[e]){const r={data:t[s],key:a[s]?.key,metadata:a[s]};n.splice(e,1,r)}})),n}(i,l,h,u):d?.size&&(u=function(e,t,a,n,r){const o=[...n];return e.forEach((e=>{const n=s(r,e),i={data:t[n],key:a[n]?.key,metadata:a[n]};n>=0&&o.splice(n,1,i)})),o}(d,l,h,u,n)));return u}(c,l,u,o)),l}})),define("oj-c/hooks/UNSAFE_useDataProvider/DataProviderHandler",["require","exports","./utils"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DataProviderHandler=void 0;e.DataProviderHandler=class{constructor(e,a,s){this.handleMutateEvent=async e=>{const{detail:a}=e,s=this.addBusyState("updating data from mutation event"),n=await(0,t.getUpdatedItemsFromMutationDetail)(a,this.currentData,this.dataProvider);s?.(),this.currentData=n,this.callback?.onDataUpdated?.(n)},this.handleRefreshEvent=()=>{this._fetchDataAndNotify()},this.addBusyState=a,this.callback=s,this.dataProvider=e,this.currentData=[],e.addEventListener("refresh",this.handleRefreshEvent),e.addEventListener("mutate",this.handleMutateEvent),this._fetchDataAndNotify()}destroy(){this.callback=void 0,this.currentData=[],this.dataProvider.removeEventListener("refresh",this.handleRefreshEvent),this.dataProvider.removeEventListener("mutate",this.handleMutateEvent)}async _fetchData(){const e=[],t=this.dataProvider.fetchFirst({size:-1});for await(const a of t){const t=a.data.map(((e,t)=>({data:e,key:a.metadata[t].key,metadata:a.metadata[t]})));e.push(...t)}return this.currentData=e.slice(),e}async _fetchDataAndNotify(){const e=this.addBusyState("fetching data"),t=await this._fetchData();this.callback?.onDataUpdated?.(t),e()}}})),define("oj-c/hooks/UNSAFE_useDataProvider/useDataProvider",["require","exports","preact/hooks","./DataProviderHandler"],(function(require,e,t,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useDataProvider=void 0,e.useDataProvider=function({addBusyState:e,data:s}){const[n,r]=(0,t.useState)([]),o=(0,t.useRef)();return(0,t.useEffect)((()=>(void 0!==s&&(o.current=new a.DataProviderHandler(s,e,{onDataUpdated:r})),()=>{o.current?.destroy(),o.current=void 0})),[s,e]),{data:n}}})),define("oj-c/message-banner/message-banner",["require","exports","preact/jsx-runtime","@oracle/oraclejet-preact/translationBundle","@oracle/oraclejet-preact/UNSAFE_MessageBanner","@oracle/oraclejet-preact/hooks/UNSAFE_useMessagesContext","ojs/ojvcomponent","preact/hooks","../hooks/UNSAFE_useDataProvider/useDataProvider","ojs/ojcontext","css!oj-c/message-banner/message-banner-styles.css"],(function(require,e,t,a,s,n,r,o,i,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MessageBanner=void 0,e.MessageBanner=(0,r.registerCustomElement)("oj-c-message-banner",(function({data:e,detailTemplateValue:a,messageTemplates:c,type:u="section",onOjClose:l}){const h=(0,o.useRef)(e),f=(0,o.useRef)(),[p,y]=(0,o.useState)(0),v=(0,o.useCallback)(((e="MessageBanner: busyState")=>f.current?d.getContext(f.current).getBusyContext().addBusyState({description:e}):()=>{}),[]),m=(0,o.useMemo)((()=>({addBusyState:v})),[v]);e!=h.current&&(y((e=>e+1)),h.current=e);const{data:g}=(0,i.useDataProvider)({data:e,addBusyState:v});return(0,t.jsx)(r.Root,{ref:f,children:(0,t.jsx)(n.MessagesContext.Provider,{value:m,children:(0,t.jsx)(s.MessageBanner,{data:g,detailRendererKey:a,renderers:c,variant:u,onClose:l},`dp-${p}`)})})}),"MessageBanner",{properties:{data:{type:"DataProvider"},type:{type:"string",enumValues:["page","section"]},detailTemplateValue:{type:"string|function"}},extension:{_DYNAMIC_SLOT:{prop:"messageTemplates",isTemplate:1}},events:{ojClose:{}}},{type:"section"},{"@oracle/oraclejet-preact":a.default})}));
//# sourceMappingURL=message-banner.js.map